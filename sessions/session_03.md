# Session 03: 複雑な機能開発～プランモードを活用したカレンダー機能実装

## 📌 このセッションで学ぶこと

- **プランモード** とは何か、どう活用するか
- 複雑な要件を段階的に計画する方法
- プランを確認してから実装に進む流れ
- 月・週表示するカレンダー機能の実装

---

## 🎯 セッション概要

| ステップ   | 目的                               | 所要時間 |
| ---------- | ---------------------------------- | -------- |
| ステップ 1 | プランモードについて学ぶ           | 5 分     |
| ステップ 2 | プランモードを有効にして要件説明   | 5 分     |
| ステップ 3 | 作成されたプランを確認・修正・承認 | 10 分    |
| ステップ 4 | 実装を依頼                         | 5 分     |
| ステップ 5 | 動作確認                           | 10 分    |

**合計：約 35 分**

---

## ステップ 1: プランモードについて学ぶ

### 🎯 目的

ClaudeCode の **プランモード** がどのようなものか、なぜ複雑な機能開発で必要か理解します。

### 💬 参加者の操作

```
特にやることはありません。以下を理解してください：
```

### 📚 プランモードとは

Session 02 までは **シンプルな機能** だったので、「要件 → 実装」で直結していました。

でも **カレンダー機能** は複雑です：

- 📅 カレンダーライブラリを選定する必要
- 🗓️ 月表示・週表示のいずれも実装
- 📍 タスク期限の表示
- ✏️ カレンダーからのタスク作成
- 🎯 複数のコンポーネント・ロジックが必要

**プランモード** は、実装前に Claude が以下を **計画立てる** 機能です。プランモードを有効にすると：

```
Claude は実装を進める前に、以下を提示：
1. ライブラリ選定
2. 実装するファイル一覧
3. 各ステップの実装順序
4. 各ステップの詳細タスク
5. 見積もり

その後、「このプランでいいか？」と確認を待ちます。
```

### 💡 学習ポイント

- 🧠 **複雑さの可視化：** 実装前に全体像が見える
- ✅ **品質向上：** 計画立てることで、漏れや矛盾がなくなる
- 🔄 **修正が容易：** 実装後の修正より、計画段階での修正が効率的
- 📋 **チームコミュニケーション：** プランを確認して、方針に合意してから実装

---

## ステップ 2: プランモードを有効にして要件説明

### 🎯 目的

プランモードを有効にしてから、カレンダー機能の要件を説明して、プランを作成してもらいます。

### 💬 参加者の操作

```
1. ClaudeCode チャットを開く

   ↓

2. Shift + Tab を押す

   ↓

3. 画面下部に「plan mode on」と表示される

   ↓

4. チャットに以下を入力して送信：

   「チケット管理アプリにカレンダー機能を追加したい。

    要件：
    - 新しいページ /calendar を作成
    - カレンダーで期限日を視覚的に表示
    - 月表示と週表示に対応（日表示は不要）
    - カレンダー上の日付をクリックしてタスク新規作成
    - 新規作成時、クリックした日付が期限日のデフォルト値
    - タスク作成後、カレンダーに自動反映

    必要ならライブラリを導入してください。

    段階的な実装計画を作成してもらえますか？」

   ↓

5. Claudeが実装計画を作成
```

### 📚 何が起きているのか

プランモード有効時に要件説明すると、Claudeは以下を分析して計画を立てます：

- 📦 「どのカレンダーライブラリが最適か」
- 📁 「app/calendar/page.tsx を作成」「components/Calendar/ を新規作成」など
- 🔄 「まず基本的な月表示から実装」「次に週表示」
- ✅ 「実装順序と依存関係」

### 💡 学習ポイント

- 📋 **要件を詳しく説明：** 曖昧さがあると、プランも不完全
- 🎯 **開発の透明性：** 実装前に「何をするか」が明確
- 🧩 **モジュール化：** 大きな機能を小さなステップに分割

---

## ステップ 3: プランを確認・修正・承認

### 🎯 目的

Claudeが作成したプランを確認して、修正が必要か判断します。

### 💬 参加者の操作

```
1. Claudeのプランを読む

   以下をチェック：
   - ❓ 実装手順は合理的か
   - ❓ ライブラリ選定は適切か
   - ❓ ステップ数は適切か（多すぎないか）
   - ❓ 何か抜けている機能がないか

   ↓

2-A. プランが良ければ：

   「このプランで進めてください」

   ↓

2-B. 修正が必要なら：

   「プランの〇〇を修正してください」
   「△△の部分をこうしたいのですが」

   ↓

3. Claudeが修正したプランを提示

   ↓

4. OK なら：

   「このプランで実装をお願いします」
```

### 📚 プランの確認ポイント

プランを見るときの **チェックリスト**：

- 📦 **ライブラリ選定は合理的か**
  - 例：「react-big-calendar」が提案されたなら、それは適切か？
  - 理由が説明されているか？

- 📁 **ファイル構成は合理的か**
  - 新規作成するコンポーネントが過度に多くないか？
  - 既存の `components/` 構造と整合性がある？

- 🔄 **実装順序に依存関係がある？**
  - 「1. ライブラリ導入」→「2. 基本カレンダー表示」→「3. 月表示」など
  - 順序は適切か？

- ⚠️ **実装期間は適切か**
  - 「合計 2 時間」は現実的か？
  - 複雑さと見積もりが釣り合っているか？

### 💡 学習ポイント

- 🧪 **プラン段階での修正は安い：** 実装後の修正より効率的
- 👥 **コミュニケーション：** 方針を共有してから進める重要性
- 📊 **計画の精度：** 良い計画があると、実装がスムーズ

### 🎲 修正例

もし「ステップが多すぎる」なら：

```
「プランが 10 ステップもあります。
 もっとシンプルにできませんか？
 まず月表示だけ実装して、
 週表示は次のセッションでいいです」

↓

Claudeが調整したプランを提示

↓

「このプランで実装をお願いします」
```

---

## ステップ 4: 実装を依頼

### 🎯 目的

承認したプランに基づいて、Claudeに実装を依頼します。

### 💬 参加者の操作

```
1. チャットで以下を入力：

   「承認したプランに基づいて、
    実装とテストをお願いします」

   ↓

2. Claudeが実装開始

   ↓

3. 完了を待つ
```

### 📚 何が起きているのか

プランが確定しているので、Claudeは **迷わずに実装** できます：

- 📦 ライブラリは既に決定済み
- 📁 ファイル構成も決定済み
- 🔄 実装順序も決定済み

**プランなしで実装する場合と比べて、実装の質が向上します。**

### 💡 学習ポイント

- ⚡ **効率化：** プランがあると、実装がスムーズ
- ✅ **品質：** 計画段階での検討が、品質に直結
- 🎯 **信頼性：** 「計画通り」という安心感

---

## ステップ 5: 動作確認

### 🎯 目的

実装したカレンダー機能が要件通り動いているか確認します。

### 💬 参加者の操作

```
1. 開発サーバーを起動：
   npm run dev

   ↓

2. http://localhost:3000/calendar を開く

   ↓

3. 以下を確認：
   - ✅ カレンダーが表示される
   - ✅ 月表示・週表示に切り替えられる
   - ✅ タスク期限が表示されている
   - ✅ カレンダー上の日付をクリックして新規作成できる
   - ✅ 新規作成時、選択日付が期限日デフォルト値

   ↓

4. テストを実行：
   npm test

   ↓

5. テストが PASS することを確認
```

### 📚 確認項目

- 📅 カレンダーの表示
- 📍 タスク期限の表示
- ✏️ 新規作成フロー
- 🔄 月・週表示の切り替え

### 💡 学習ポイント

- 🎯 **プランから実装へ：** プランがあると、確認項目も明確
- ✅ **テスト：** 実装の品質を自動保証
- 🚀 **複雑な機能も対応可能：** プランモードなら安心

### 🎲 もし動かない場合

```
「カレンダーが表示されません」
「週表示がうまく動きません」

↓

Claudeに状況を伝える

↓

Claudeが修正
```

---

## ✅ セッション完了チェック

- [ ] プランモード（Shift+Tab で「plan mode on」）について理解した
- [ ] プランモードを有効にしてから要件を説明した
- [ ] Claudeが作成したプランを確認した
- [ ] 必要に応じてプランを修正・承認した
- [ ] 「このプランで実装をお願いします」と指示した
- [ ] http://localhost:3000/calendar でカレンダーが表示される
- [ ] 月表示・週表示に切り替えられることを確認した
- [ ] カレンダー上の日付をクリックしてタスク作成できることを確認した
- [ ] テストが全て PASS したことを確認した

---

## 💾 セッション完了後のコミット

**Session 03 で実装したカレンダー機能を Git に保存しておきましょう。**

```bash
# 変更を確認
git status

# 実装を追加
git add .

# Session 03 完了時点をコミット
git commit -m "feat: Session 03 complete - calendar feature implementation

- Implemented /calendar page with calendar UI
- Added month/week view switching
- Integrated task deadline display on calendar
- Enabled task creation from calendar date clicks
- Created comprehensive E2E tests
- All tests passing"

# 進捗確認
git log --oneline
```

---

## 📌 このセッションで学んだこと

- 📋 **プランモード：** Shift+Tab で有効化。複雑な機能を計画立てる
- ✅ **事前計画の効果：** 計画段階での修正が、実装後の修正より効率的
- 🎯 **大型機能開発：** プランモード有効 → 要件説明 → プラン確認 → 実装というフロー
- 🚀 **スケーラビリティ：** シンプルな機能から複雑な機能まで、同じ流れで対応可能

---

## 📌 次のセッションへ向けて

次のセッション（Session 04）では、**ドキュメント生成** に挑戦します：

- **API 仕様書の自動生成**（Session 03 で実装したカレンダー API の仕様書を作成）
- **アーキテクチャドキュメント作成**（システム全体を図解）
- **データベーススキーマドキュメント生成**

Session 03 で体験した「プランモード → 実装」のフローに加えて、Session 04 では **「コード → ドキュメント」の自動化** を学びます。

実装したコードから効率的にドキュメントを生成することで、チーム開発がさらに進みます。

💡 **複雑な機能開発は計画的に進め、その成果を効率的にドキュメント化できるようになります！**
